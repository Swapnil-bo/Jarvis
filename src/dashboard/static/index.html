<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>J.A.R.V.I.S. â€” Dashboard</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Sora:wght@300;400;500;600&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   J.A.R.V.I.S. DASHBOARD â€” Glassmorphism 2.0
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

:root {
    --bg:         #070a13;
    --surface:    rgba(12, 17, 30, 0.55);
    --surface-hi: rgba(20, 28, 50, 0.45);
    --border:     rgba(255, 255, 255, 0.055);
    --border-hi:  rgba(255, 255, 255, 0.1);
    --cyan:       #00e5ff;
    --cyan-dim:   #007a8a;
    --cyan-glow:  rgba(0, 229, 255, 0.12);
    --purple:     #a855f7;
    --purple-dim: #6b21a8;
    --purple-glow:rgba(168, 85, 247, 0.1);
    --green:      #34d399;
    --amber:      #fbbf24;
    --red:        #f87171;
    --text:       #e2e8f0;
    --text-sec:   #94a3b8;
    --text-muted: #475569;
    --font-display: 'Orbitron', monospace;
    --font-body:    'Sora', sans-serif;
    --font-mono:    'JetBrains Mono', monospace;
    --radius:     14px;
    --blur:       24px;
}

*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--font-body);
    font-size: 13px;
    height: 100vh;
    overflow: hidden;
    -webkit-font-smoothing: antialiased;
}

/* â”€â”€ Background Gradient Orbs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.bg-orbs { position: fixed; inset: 0; z-index: 0; overflow: hidden; pointer-events: none; }
.orb {
    position: absolute;
    border-radius: 50%;
    filter: blur(140px);
    opacity: 0.12;
    will-change: transform;
}
.orb-1 { width: 700px; height: 700px; background: var(--cyan); top: -250px; left: -150px; animation: drift1 25s ease-in-out infinite; }
.orb-2 { width: 550px; height: 550px; background: var(--purple); bottom: -250px; right: -100px; animation: drift2 30s ease-in-out infinite; }
.orb-3 { width: 300px; height: 300px; background: var(--cyan); top: 50%; left: 50%; transform: translate(-50%,-50%); animation: drift3 20s ease-in-out infinite; opacity: 0.06; }

@keyframes drift1 { 0%,100% { transform: translate(0,0) scale(1); } 50% { transform: translate(80px,60px) scale(1.1); } }
@keyframes drift2 { 0%,100% { transform: translate(0,0) scale(1); } 50% { transform: translate(-60px,-80px) scale(1.08); } }
@keyframes drift3 { 0%,100% { transform: translate(-50%,-50%) scale(1); } 50% { transform: translate(-40%,-60%) scale(1.3); } }

/* â”€â”€ Noise Overlay â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.noise {
    position: fixed; inset: 0; z-index: 1; pointer-events: none; opacity: 0.025;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
}

/* â”€â”€ Dashboard Grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.dashboard {
    position: relative; z-index: 2;
    display: grid;
    grid-template-columns: 260px 1fr 280px;
    grid-template-rows: 54px 1fr;
    gap: 12px;
    padding: 12px;
    height: 100vh;
}

/* â”€â”€ Glass Panel Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.glass {
    background: var(--surface);
    backdrop-filter: blur(var(--blur));
    -webkit-backdrop-filter: blur(var(--blur));
    border: 1px solid var(--border);
    border-radius: var(--radius);
    overflow: hidden;
}
.glass-hi {
    background: var(--surface-hi);
    border-color: var(--border-hi);
}

/* â”€â”€ Header Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.header {
    grid-column: 1 / -1;
    display: flex;
    align-items: center;
    padding: 0 20px;
    gap: 20px;
}

.logo {
    font-family: var(--font-display);
    font-weight: 700;
    font-size: 16px;
    letter-spacing: 3px;
    background: linear-gradient(135deg, var(--cyan), var(--purple));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.status-badge {
    display: flex; align-items: center; gap: 6px;
    font-family: var(--font-mono);
    font-size: 11px;
    font-weight: 500;
    color: var(--green);
    padding: 4px 12px;
    border-radius: 20px;
    background: rgba(52, 211, 153, 0.08);
    border: 1px solid rgba(52, 211, 153, 0.15);
}
.status-badge .dot {
    width: 6px; height: 6px; border-radius: 50%;
    background: var(--green);
    animation: pulse-dot 2s ease-in-out infinite;
}
.status-badge.listening { color: var(--cyan); background: rgba(0,229,255,0.08); border-color: rgba(0,229,255,0.15); }
.status-badge.listening .dot { background: var(--cyan); animation: pulse-dot 0.8s ease-in-out infinite; }
.status-badge.thinking { color: var(--purple); background: rgba(168,85,247,0.08); border-color: rgba(168,85,247,0.15); }
.status-badge.thinking .dot { background: var(--purple); animation: pulse-dot 0.5s ease-in-out infinite; }
.status-badge.speaking { color: var(--amber); background: rgba(251,191,36,0.08); border-color: rgba(251,191,36,0.15); }
.status-badge.speaking .dot { background: var(--amber); }

@keyframes pulse-dot { 0%,100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.4; transform: scale(0.7); } }

.header-stats {
    display: flex; gap: 16px; margin-left: auto;
    font-family: var(--font-mono);
    font-size: 11px;
    color: var(--text-muted);
}
.header-stats span { display: flex; align-items: center; gap: 5px; }
.header-stats .val { color: var(--text-sec); }

/* â”€â”€ Left Panel: Status Ring + Stats â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.panel-left {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px 16px;
    gap: 20px;
}

/* Status Ring */
.ring-container {
    position: relative;
    width: 180px;
    height: 180px;
}

.ring-svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}

.ring-bg {
    fill: none;
    stroke: rgba(255,255,255,0.03);
    stroke-width: 2;
}

.ring-arc {
    fill: none;
    stroke-linecap: round;
    transition: all 0.6s ease;
}

.arc-1 {
    stroke: url(#grad-cyan);
    stroke-width: 2.5;
    stroke-dasharray: 130 404;
    animation: spin-cw 10s linear infinite;
    filter: drop-shadow(0 0 6px var(--cyan-glow));
}

.arc-2 {
    stroke: url(#grad-purple);
    stroke-width: 1.5;
    stroke-dasharray: 80 432;
    animation: spin-ccw 14s linear infinite;
    filter: drop-shadow(0 0 4px var(--purple-glow));
}

.arc-3 {
    stroke: var(--cyan);
    stroke-width: 1;
    stroke-dasharray: 20 514;
    animation: spin-cw 6s linear infinite;
    opacity: 0.4;
}

@keyframes spin-cw  { to { transform: rotate(360deg); } }
@keyframes spin-ccw { to { transform: rotate(-360deg); } }

/* Ring center content (overlaid, not rotated) */
.ring-center {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 4px;
}

.ring-icon {
    font-size: 28px;
    opacity: 0.6;
    transition: all 0.4s ease;
}

.ring-label {
    font-family: var(--font-display);
    font-size: 10px;
    letter-spacing: 4px;
    color: var(--text-muted);
    transition: color 0.4s ease;
}

/* Ring state changes */
[data-state="listening"] .arc-1 { stroke-dasharray: 300 234; animation-duration: 3s; filter: drop-shadow(0 0 14px rgba(0,229,255,0.3)); }
[data-state="listening"] .arc-2 { stroke-dasharray: 200 312; animation-duration: 4s; }
[data-state="listening"] .ring-icon { opacity: 1; color: var(--cyan); transform: scale(1.1); }
[data-state="listening"] .ring-label { color: var(--cyan); }
[data-state="listening"] .ring-glow { opacity: 0.15; }

[data-state="thinking"] .arc-1 { animation-duration: 2s; stroke: url(#grad-purple); }
[data-state="thinking"] .arc-2 { animation-duration: 2.5s; }
[data-state="thinking"] .ring-icon { opacity: 1; color: var(--purple); }
[data-state="thinking"] .ring-label { color: var(--purple); }

[data-state="speaking"] .arc-1 { stroke-dasharray: 80 454; animation-duration: 4s; }
[data-state="speaking"] .arc-2 { stroke-dasharray: 60 452; animation-duration: 5s; }
[data-state="speaking"] .ring-icon { opacity: 1; color: var(--amber); }
[data-state="speaking"] .ring-label { color: var(--amber); }

.ring-glow {
    position: absolute;
    inset: 10px;
    border-radius: 50%;
    background: radial-gradient(circle, var(--cyan-glow), transparent 70%);
    opacity: 0.05;
    transition: opacity 0.6s ease;
}

/* Quick stats grid */
.quick-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
    width: 100%;
}

.stat-card {
    padding: 12px;
    border-radius: 10px;
    background: rgba(255,255,255,0.02);
    border: 1px solid var(--border);
    text-align: center;
}

.stat-card .stat-value {
    font-family: var(--font-mono);
    font-size: 18px;
    font-weight: 500;
    color: var(--text);
}

.stat-card .stat-label {
    font-size: 9px;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-top: 4px;
}

/* â”€â”€ Center Panel: Conversation Feed â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.panel-center {
    display: flex;
    flex-direction: column;
}

.panel-title {
    font-family: var(--font-display);
    font-size: 10px;
    letter-spacing: 3px;
    color: var(--text-muted);
    padding: 14px 18px 10px;
    border-bottom: 1px solid var(--border);
    flex-shrink: 0;
}

.chat-feed {
    flex: 1;
    overflow-y: auto;
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.msg {
    max-width: 85%;
    padding: 10px 14px;
    border-radius: 12px;
    font-size: 13px;
    line-height: 1.5;
    animation: msg-in 0.3s ease-out;
    position: relative;
}

@keyframes msg-in {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
}

.msg-user {
    align-self: flex-end;
    background: rgba(0, 229, 255, 0.08);
    border: 1px solid rgba(0, 229, 255, 0.12);
    color: var(--text);
    border-bottom-right-radius: 4px;
}

.msg-jarvis {
    align-self: flex-start;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid var(--border);
    color: var(--text-sec);
    border-bottom-left-radius: 4px;
}

.msg-system {
    align-self: center;
    font-family: var(--font-mono);
    font-size: 10px;
    color: var(--text-muted);
    padding: 4px 12px;
    background: rgba(255,255,255,0.02);
    border-radius: 20px;
    max-width: 100%;
}

.msg-sender {
    font-family: var(--font-mono);
    font-size: 9px;
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-bottom: 4px;
}

.msg-user .msg-sender { color: var(--cyan-dim); }
.msg-jarvis .msg-sender { color: var(--text-muted); }

.msg-time {
    font-family: var(--font-mono);
    font-size: 9px;
    color: var(--text-muted);
    margin-top: 4px;
    text-align: right;
}

/* Empty state */
.empty-state {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 8px;
    color: var(--text-muted);
}
.empty-state .empty-icon { font-size: 32px; opacity: 0.3; }
.empty-state .empty-text { font-size: 12px; opacity: 0.5; }

/* â”€â”€ Right Panel: Monitor + Router â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.panel-right {
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: 0;
    background: none;
    border: none;
    backdrop-filter: none;
}

.sub-panel {
    border-radius: var(--radius);
    background: var(--surface);
    backdrop-filter: blur(var(--blur));
    -webkit-backdrop-filter: blur(var(--blur));
    border: 1px solid var(--border);
    overflow: hidden;
}

/* System Monitor */
.monitor {
    padding: 14px 16px;
    flex-shrink: 0;
}

.gauge-row {
    display: flex;
    gap: 16px;
    margin-top: 12px;
}

.gauge {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
}

.gauge-ring {
    position: relative;
    width: 64px;
    height: 64px;
}

.gauge-svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}

.gauge-track {
    fill: none;
    stroke: rgba(255,255,255,0.04);
    stroke-width: 4;
}

.gauge-fill {
    fill: none;
    stroke-width: 4;
    stroke-linecap: round;
    transition: stroke-dashoffset 1s ease, stroke 0.5s ease;
}

.gauge-fill.battery { stroke: var(--green); }
.gauge-fill.battery.low { stroke: var(--red); }
.gauge-fill.ram { stroke: var(--cyan); }
.gauge-fill.ram.high { stroke: var(--amber); }

.gauge-value {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--font-mono);
    font-size: 13px;
    font-weight: 500;
}

.gauge-label {
    font-size: 9px;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--text-muted);
}

/* Tool Router Feed */
.router-feed {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.router-list {
    flex: 1;
    overflow-y: auto;
    padding: 8px 12px;
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.route-entry {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    padding: 8px 10px;
    border-radius: 8px;
    background: rgba(255,255,255,0.015);
    border: 1px solid rgba(255,255,255,0.03);
    animation: msg-in 0.3s ease-out;
    font-family: var(--font-mono);
    font-size: 11px;
}

.route-icon {
    width: 18px;
    height: 18px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    flex-shrink: 0;
    margin-top: 1px;
}

.route-icon.system_info { background: rgba(52,211,153,0.15); }
.route-icon.mac_control { background: rgba(251,191,36,0.15); }
.route-icon.reminder { background: rgba(168,85,247,0.15); }
.route-icon.web_search { background: rgba(0,229,255,0.15); }
.route-icon.whatsapp { background: rgba(37,211,102,0.15); }
.route-icon.chat { background: rgba(255,255,255,0.05); }

.route-details { flex: 1; }
.route-tool { color: var(--text-sec); font-weight: 500; }
.route-action { color: var(--text-muted); font-size: 10px; }

.route-time {
    font-size: 9px;
    color: var(--text-muted);
    flex-shrink: 0;
    opacity: 0.6;
}

/* Memory Stats */
.memory-stats {
    padding: 14px 16px;
    flex-shrink: 0;
}

.mem-row {
    display: flex;
    justify-content: space-between;
    padding: 6px 0;
    font-size: 11px;
}

.mem-row .mem-label { color: var(--text-muted); }
.mem-row .mem-value { font-family: var(--font-mono); color: var(--text-sec); }

/* â”€â”€ Scrollbar Styling â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.15); }

/* â”€â”€ Connection status â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.connection-bar {
    position: fixed;
    top: 0; left: 0; right: 0;
    height: 2px;
    z-index: 100;
    transition: opacity 0.3s ease;
}
.connection-bar.connected { background: var(--cyan); opacity: 0.5; animation: conn-pulse 3s ease-in-out infinite; }
.connection-bar.disconnected { background: var(--red); opacity: 0.8; }

@keyframes conn-pulse { 0%,100% { opacity: 0.3; } 50% { opacity: 0.7; } }

/* â”€â”€ Loading shimmer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.shimmer {
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.03), transparent);
    background-size: 200% 100%;
    animation: shimmer 2s ease infinite;
}
@keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
</style>
</head>
<body>

<!-- Background Effects -->
<div class="bg-orbs">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>
</div>
<div class="noise"></div>

<!-- Connection Status Bar -->
<div class="connection-bar disconnected" id="connBar"></div>

<!-- Dashboard Grid -->
<div class="dashboard">

    <!-- â•â•â• Header â•â•â• -->
    <header class="header glass">
        <div class="logo">J.A.R.V.I.S.</div>
        <div class="status-badge" id="statusBadge">
            <div class="dot"></div>
            <span id="statusText">CONNECTING</span>
        </div>
        <div class="header-stats">
            <span>â± <span class="val" id="uptime">00:00:00</span></span>
            <span>ğŸ™ <span class="val" id="wakeCount">0</span></span>
            <span>ğŸ”§ <span class="val" id="toolCount">0</span></span>
        </div>
    </header>

    <!-- â•â•â• Left Panel: Status Ring + Quick Stats â•â•â• -->
    <section class="panel-left glass" id="leftPanel" data-state="idle">
        <div class="ring-container">
            <div class="ring-glow"></div>
            <svg class="ring-svg" viewBox="0 0 200 200">
                <defs>
                    <linearGradient id="grad-cyan" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#00e5ff" stop-opacity="0.9"/>
                        <stop offset="100%" stop-color="#00e5ff" stop-opacity="0.1"/>
                    </linearGradient>
                    <linearGradient id="grad-purple" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#a855f7" stop-opacity="0.7"/>
                        <stop offset="100%" stop-color="#a855f7" stop-opacity="0.05"/>
                    </linearGradient>
                </defs>
                <circle class="ring-bg" cx="100" cy="100" r="85"/>
                <circle class="ring-bg" cx="100" cy="100" r="75"/>
                <circle class="ring-arc arc-1" cx="100" cy="100" r="85"/>
                <circle class="ring-arc arc-2" cx="100" cy="100" r="75"/>
                <circle class="ring-arc arc-3" cx="100" cy="100" r="65"/>
            </svg>
            <div class="ring-center">
                <div class="ring-icon" id="ringIcon">â¬¡</div>
                <div class="ring-label" id="ringLabel">IDLE</div>
            </div>
        </div>

        <div class="quick-stats">
            <div class="stat-card">
                <div class="stat-value" id="exchangeCount">0</div>
                <div class="stat-label">Exchanges</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="factCount">0</div>
                <div class="stat-label">Facts</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="ramProcess">â€”</div>
                <div class="stat-label">Proc RAM</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="peakRam">â€”</div>
                <div class="stat-label">Peak RAM</div>
            </div>
        </div>
    </section>

    <!-- â•â•â• Center Panel: Conversation Feed â•â•â• -->
    <section class="panel-center glass">
        <div class="panel-title">CONVERSATION</div>
        <div class="chat-feed" id="chatFeed">
            <div class="empty-state" id="emptyState">
                <div class="empty-icon">â¬¡</div>
                <div class="empty-text">Say "Hey Jarvis" to begin</div>
            </div>
        </div>
    </section>

    <!-- â•â•â• Right Panel: Monitor + Router â•â•â• -->
    <aside class="panel-right">

        <!-- System Monitor -->
        <div class="sub-panel monitor">
            <div class="panel-title" style="padding:0 0 4px; border:none;">SYSTEM</div>
            <div class="gauge-row">
                <!-- Battery Gauge -->
                <div class="gauge">
                    <div class="gauge-ring">
                        <svg class="gauge-svg" viewBox="0 0 80 80">
                            <circle class="gauge-track" cx="40" cy="40" r="32"/>
                            <circle class="gauge-fill battery" id="batteryFill" cx="40" cy="40" r="32"
                                    stroke-dasharray="201" stroke-dashoffset="201"/>
                        </svg>
                        <div class="gauge-value" id="batteryVal">â€”</div>
                    </div>
                    <div class="gauge-label">Battery</div>
                </div>
                <!-- RAM Gauge -->
                <div class="gauge">
                    <div class="gauge-ring">
                        <svg class="gauge-svg" viewBox="0 0 80 80">
                            <circle class="gauge-track" cx="40" cy="40" r="32"/>
                            <circle class="gauge-fill ram" id="ramFill" cx="40" cy="40" r="32"
                                    stroke-dasharray="201" stroke-dashoffset="201"/>
                        </svg>
                        <div class="gauge-value" id="ramVal">â€”</div>
                    </div>
                    <div class="gauge-label">RAM</div>
                </div>
            </div>
        </div>

        <!-- Tool Router Feed -->
        <div class="sub-panel router-feed" style="flex:1;">
            <div class="panel-title" style="padding:12px 16px 8px;">TOOL ROUTER</div>
            <div class="router-list" id="routerList"></div>
        </div>

        <!-- Memory Stats -->
        <div class="sub-panel memory-stats">
            <div class="panel-title" style="padding:0 0 8px; border:none;">MEMORY</div>
            <div class="mem-row"><span class="mem-label">Conversations</span><span class="mem-value" id="memExchanges">â€”</span></div>
            <div class="mem-row"><span class="mem-label">User Facts</span><span class="mem-value" id="memFacts">â€”</span></div>
            <div class="mem-row"><span class="mem-label">Tools Used</span><span class="mem-value" id="memTools">â€”</span></div>
        </div>
    </aside>

</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JavaScript: WebSocket + Real-Time Updates
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
(() => {
    'use strict';

    // â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let ws = null;
    let reconnectTimer = null;
    let uptimeStart = Date.now();
    let peakRam = 0;
    const TOOL_ICONS = {
        system_info: 'ğŸ“Š', mac_control: 'ğŸ’»', reminder: 'â±',
        web_search: 'ğŸ”', whatsapp: 'ğŸ“±', none: 'ğŸ’¬'
    };

    // â”€â”€ DOM References â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const $ = id => document.getElementById(id);
    const connBar     = $('connBar');
    const statusBadge = $('statusBadge');
    const statusText  = $('statusText');
    const leftPanel   = $('leftPanel');
    const ringIcon    = $('ringIcon');
    const ringLabel   = $('ringLabel');
    const chatFeed    = $('chatFeed');
    const emptyState  = $('emptyState');
    const routerList  = $('routerList');

    // â”€â”€ WebSocket Connection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function connect() {
        const proto = location.protocol === 'https:' ? 'wss' : 'ws';
        ws = new WebSocket(`${proto}://${location.host}/ws`);

        ws.onopen = () => {
            connBar.className = 'connection-bar connected';
            setStatus('online', 'ONLINE');
            // Ping to keep alive
            setInterval(() => { if (ws.readyState === 1) ws.send('ping'); }, 30000);
        };

        ws.onmessage = (e) => {
            try {
                const event = JSON.parse(e.data);
                handleEvent(event);
            } catch (err) {
                console.warn('Bad event:', e.data);
            }
        };

        ws.onclose = () => {
            connBar.className = 'connection-bar disconnected';
            setStatus('offline', 'OFFLINE');
            // Reconnect after 2s
            clearTimeout(reconnectTimer);
            reconnectTimer = setTimeout(connect, 2000);
        };

        ws.onerror = () => ws.close();
    }

    // â”€â”€ Event Router â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function handleEvent(ev) {
        switch (ev.type) {
            case 'snapshot':      onSnapshot(ev); break;
            case 'status':        onStatus(ev); break;
            case 'transcription': onTranscription(ev); break;
            case 'routing':       onRouting(ev); break;
            case 'response':      onResponse(ev); break;
            case 'telemetry':     onTelemetry(ev); break;
            case 'wake_word':     onWake(ev); break;
        }
    }

    // â”€â”€ Event Handlers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    function onSnapshot(ev) {
        uptimeStart = Date.now() - (ev.uptime * 1000);
        $('wakeCount').textContent = ev.wake_count || 0;
        $('toolCount').textContent = ev.tool_count || 0;
        $('exchangeCount').textContent = ev.exchange_count || 0;
        $('memTools').textContent = ev.tool_count || 0;
    }

    function onStatus(ev) {
        const state = ev.state;
        leftPanel.setAttribute('data-state', state);

        const map = {
            idle:          { label: 'IDLE',      icon: 'â¬¡', badge: '',          text: 'ONLINE' },
            online:        { label: 'ONLINE',    icon: 'â¬¡', badge: '',          text: 'ONLINE' },
            wake_detected: { label: 'WAKE',      icon: 'ğŸ‘‚', badge: 'listening', text: 'WAKE WORD' },
            listening:     { label: 'LISTENING',  icon: 'ğŸ™', badge: 'listening', text: 'LISTENING' },
            thinking:      { label: 'THINKING',   icon: 'ğŸ§ ', badge: 'thinking',  text: 'THINKING' },
            speaking:      { label: 'SPEAKING',   icon: 'ğŸ”Š', badge: 'speaking',  text: 'SPEAKING' },
        };

        const cfg = map[state] || map.idle;
        ringIcon.textContent = cfg.icon;
        ringLabel.textContent = cfg.label;
        setStatus(cfg.badge, cfg.text);
    }

    function onWake(ev) {
        const count = parseInt($('wakeCount').textContent) + 1;
        $('wakeCount').textContent = count;
        addSystemMsg(`Wake word: "${ev.phrase}"`);
    }

    function onTranscription(ev) {
        if (emptyState) emptyState.remove();
        addChatMsg('user', ev.text);
    }

    function onRouting(ev) {
        const count = parseInt($('toolCount').textContent) + 1;
        $('toolCount').textContent = count;
        $('memTools').textContent = count;

        const icon = TOOL_ICONS[ev.tool] || 'ğŸ”§';
        const toolClass = ev.tool || 'chat';
        const action = ev.action ? `â†’ ${ev.action}` : '';
        const params = ev.params && Object.keys(ev.params).length
            ? `  ${JSON.stringify(ev.params)}` : '';

        const entry = document.createElement('div');
        entry.className = 'route-entry';
        entry.innerHTML = `
            <div class="route-icon ${toolClass}">${icon}</div>
            <div class="route-details">
                <div class="route-tool">${ev.tool || 'chat'}</div>
                <div class="route-action">${action}${params}</div>
            </div>
            <div class="route-time">${timeStr()}</div>
        `;
        routerList.prepend(entry);

        // Keep max 30 entries
        while (routerList.children.length > 30) routerList.lastChild.remove();
    }

    function onResponse(ev) {
        addChatMsg('jarvis', ev.text);
        const count = parseInt($('exchangeCount').textContent) + 1;
        $('exchangeCount').textContent = count;
        $('memExchanges').textContent = count;
    }

    function onTelemetry(ev) {
        // Battery gauge
        if (ev.battery !== undefined) {
            const pct = ev.battery;
            const fill = $('batteryFill');
            const circumference = 201;
            fill.style.strokeDashoffset = circumference - (circumference * pct / 100);
            fill.classList.toggle('low', pct < 20);
            $('batteryVal').textContent = `${pct}%`;
        }

        // RAM gauge
        if (ev.ram_system !== undefined && ev.ram_total) {
            const pct = Math.round((ev.ram_system / ev.ram_total) * 100);
            const fill = $('ramFill');
            const circumference = 201;
            fill.style.strokeDashoffset = circumference - (circumference * pct / 100);
            fill.classList.toggle('high', pct > 85);
            $('ramVal').textContent = `${pct}%`;
        }

        // Process RAM
        if (ev.ram_process !== undefined) {
            $('ramProcess').textContent = `${ev.ram_process}M`;
            if (ev.ram_process > peakRam) {
                peakRam = ev.ram_process;
                $('peakRam').textContent = `${peakRam}M`;
            }
        }

        // Memory facts
        if (ev.facts !== undefined) {
            $('factCount').textContent = ev.facts;
            $('memFacts').textContent = ev.facts;
        }
        if (ev.exchanges !== undefined) {
            $('memExchanges').textContent = ev.exchanges;
        }
    }

    // â”€â”€ DOM Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    function setStatus(cls, text) {
        statusBadge.className = 'status-badge ' + cls;
        statusText.textContent = text;
    }

    function addChatMsg(role, text) {
        if (emptyState && emptyState.parentNode) emptyState.remove();
        const div = document.createElement('div');
        div.className = `msg msg-${role}`;
        div.innerHTML = `
            <div class="msg-sender">${role === 'user' ? 'YOU' : 'JARVIS'}</div>
            <div>${escHtml(text)}</div>
            <div class="msg-time">${timeStr()}</div>
        `;
        chatFeed.appendChild(div);
        chatFeed.scrollTop = chatFeed.scrollHeight;
    }

    function addSystemMsg(text) {
        if (emptyState && emptyState.parentNode) emptyState.remove();
        const div = document.createElement('div');
        div.className = 'msg msg-system';
        div.textContent = `â— ${text} â€” ${timeStr()}`;
        chatFeed.appendChild(div);
        chatFeed.scrollTop = chatFeed.scrollHeight;
    }

    function timeStr() {
        return new Date().toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit' });
    }

    function escHtml(s) {
        const d = document.createElement('div');
        d.textContent = s;
        return d.innerHTML;
    }

    // â”€â”€ Uptime Clock â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    setInterval(() => {
        const elapsed = Math.floor((Date.now() - uptimeStart) / 1000);
        const h = String(Math.floor(elapsed / 3600)).padStart(2, '0');
        const m = String(Math.floor((elapsed % 3600) / 60)).padStart(2, '0');
        const s = String(elapsed % 60).padStart(2, '0');
        $('uptime').textContent = `${h}:${m}:${s}`;
    }, 1000);

    // â”€â”€ Boot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    connect();

})();
</script>
</body>
</html>